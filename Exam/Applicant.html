<script src="http://192.168.2.161/apis/js/external/JsBarcode.js"></script>
<div id="dveconfsys_xm_Applicant" class="div-form" prefix="uxL" >
    <h2 class="title"> Applicant Registration and Validation </h2>
    <div class="div-row">
        <label>First Name</label>
        <input type="text" id="uxLFirstName" rule="{fn:'required'}" vgroup="s"  placeholder="اسم درخواست کننده  " maxlength=18  >
        <label>Father Name</label>
        <input type="text" id="uxLFatherName" rule="{fn:'required'}" vgroup="s"  placeholder="اسم پدر " />
    </div>
    <div class="div-row">
        <label>Last Name</label>
        <input type="text" id="uxLLastName" rule="{fn:'required'}" vgroup="s" placeholder="تخلص  " maxlength=18>
        <label>Address</label>
        <input id="uxLAddressID" type="text" path="look.Location" rule="{fn:'required'}" vgroup="s" class="tree" placeholder="ولایت|ولسوالی را انتخاب نماید" />
    </div>
    <div class="div-row">
        <label>NID</label>
        <input id="uxLNID" type="text" rule="{fn:'phone'}" vgroup="s"  placeholder="نمبر تذکره" />
    </div>
    <div class="div-form-control">
        <input type="submit" action="create" value="جدید" />
        <input type="submit" action="save" vgroup="s" value="ثبت" />
        <input type="submit" action="search" value="جستجو">
        <div class="toggler"></div>
    </div>
    <grid id="gveconfsys_xm_vApplicant" style="max-height:200px;">
        <column id="FirstName" caption="اسم"></column>
        <column id="FatherName" caption="اسم پدر"></column>
        <column id="NID" caption="نمبر تذکره"></column>
    </grid>
</div>
<div id="dveconfsys_xm_ApplicantOTP" class="div-form subform" parent="dveconfsys_xm_Applicant" prefix="uxM" afterbind=""  style="top:10px;"  >
    <h2 class="title">Generate OTP</h2>
    <div class="div-row">
        <label>OTP</label>
       <!-- <input type="hidden" id="uxPStatusID" value="42" default="42" keep="true" />-->
        <input type="text" id="uxMOTP" disabled="disabled"/>
    </div>
    <div class="div-row">
        <label>بارکد</label>
        <svg id="barcode1" class="Print"></svg>
    </div>
    <div class="div-form-control">
        <input type="submit" action="create" value="جدید" id="_clrbarcode" />
        <!--<input type="submit" action="save" vgroup="s" value="ثبت" />-->
        <!--<input type="submit" id="Print" value="پرنت بارکد">-->
        <input type="submit" action="save" id="_genOPT" value="GEN-OTP" onclick="fnCallMethods()"/>
        <div class="toggler"></div>
    </div>
    <grid id="gveconfsys_xm_vApplicantOTP" style="max-height:100px;">
        <column id="OTP" caption="OTP"></column>
    </grid>
</div>
<script>
    function fnCallMethods() {
        JsBarcode("#barcode1", $('#dveconfsys_xm_ApplicantOTP').data('widget').record[2]);
        var Printwindow = window.open("", "true");
        //var _temp = `
        //    <table>
        //    <thead> 
        //        <tr>
        //            <th>ID</th>
        //            <th>Name</th>
        //            <th>FatherName</th>
        //            <th>NID</th>
        //            <th>OTP<th>
        //        </tr>
        //    </thead>
        //    <tbody>
        //        <tr>
        //            <th>$ID</th>
        //            <th>$FirstName</th>
        //            <th>$LastName</th>
        //            <th>$NID</th>
        //            <th>$OTP</th>
        //        </tr>
        //    </tbody>
        //    </table>
        //    `;


        //Printwindow.document.write(_temp.replace('$ID', 1).
        //    replace("$FirstName", $('#uxFirstName').val()).
        //    replace("$LastName", $('#uxLastName').val()).
        //    replace("$NID", $('#uxLNID').val()).
        //    replace("$OTP", $('#uxMOTP')).val());
        //Printwindow.document.close();



        var templ =
            "<html>                                " +
                "    <head>                            " +
                "        <style>                       " +
                "            img{                      " +
                "               display:block;         " +
                "               margin: auto;          " +
                "               border:;" +
                "               border-radius:;     " +
                "            }                         " +
                "        </style>                      " +
                "    </head>                           " +
            "    <body>                            " +
                "  " +
                "<form style='margin:auto;'> " +
                "<fieldset style='position:relative;margin-left: 28em;margin-right: 31em;' >" +
                "<legend>" +
                "Info" +
                "</legend>" +
                "Name:$FirstName" +
                "<br>" +
                "FatherName: $FatherName" +
                "<br>" +
                "OTP:$image  " +
                "</fieldset>" +
                "" +
                "" +
                "" +
                "</form>  " +
                "" +
                "" +
                "" +
                "" +
                "" +
                "                        " +
                "                               " +
                "    </body>                           " +
                "</html>                               ";
        Printwindow.document.write(templ.replace(
            '$FirstName', $('#uxLFirstName').val())
        .replace('$FatherName', $('#uxLFatherName').val())
            .replace('$image', $("#barcode1").get(0).outerHTML)
            .replace(/"/g, '\''));
        Printwindow.document.close();
    }


    function Barcode() {

       // var t = $('#dveconfsys_xm_ApplicantOTP').data('widget').record[2];
        //var total ='AK'+t;
        //$('#uxdCode').val(total);

        //if ($('#dveconfsys_xm_ApplicantOTP').data('widget').record) {
            //  var ItemCode = $('#dvIMS_stc_BarCodeDetail').data('widget').record[1];

            // JsBarcode("#barcode1", 'GRP-AFTEL' + ItemCode + '');


            //JsBarcode("#barcode1", "GRP-AFTEL " + ItemCode + "");
            JsBarcode("#barcode1", $('#dveconfsys_xm_ApplicantOTP').data('widget').record[2]);


        //}
    }







    //$('#_clrbarcode').click(function() {
    //    $('#barcode1').innerHTML = "";
    //});
    
    //function _fnDo() {
    //    var digits = 'ABCD0123456789'; 
    //    let OTP = ''; 
    //    for (let i = 0; i <= 10; i++ ) { 
    //        OTP += digits[Math.floor(Math.random() * 10)]; 
    //    }
    //    document.getElementById('uxMOTP').value = OTP;
    //    $('#uxMOTP').val(OTP);
    //    JsBarcode("#barcode1", OTP);
    //}

    //function fnBind() {
        
    //    var _v = $('#uxMOTP').val();
    //    alert(_v);
    //    //JsBarcode("#barcode1",_v.toString());
    //}

//    var tempoo = `

//    s


//`;


    $("#Print").click(function () {
        var Printwindow = window.open("", "true");
        var templ =
            "<html>                                " +
                "    <head>                            " +
                "        <style>                       " +
                "            img{                      " +
                "               display:block;         " +
                "               margin: auto;          " +
                "               border:;" +
                "               border-radius:;     " +
                "            }                         " +
                "        </style>                      " +
                "    </head>                           " +
                "    <body>                            " +
                "         $FirstName                       " +
                "         $image                       " +
                "    </body>                           " +
                "</html>                               ";
        Printwindow.document.write(templ.replace(
            '$FirstName', $('#uxLFirstName').val())
            .replace('$image', $("#barcode1").get(0).outerHTML)
            .replace(/"/g, '\''));
        Printwindow.document.close();
    });


</script>
